<!--example for changing page title based on current view-->
<% content_for :title do %>
    KOMET Dashboard
<% end %>

<div id="komet_dashboard_splitter">
    <div id="komet_west_pane">
        <div id="komet_dashboard_tabs"  >
            <ul role="tablist">
                <li id="tab1" aria-controls="komet_taxonomy_tab"  aria-selected="true" role="tab"   tabindex="0"><a id="komet_taxonomy_tab"   href='#komet_taxonomy_tab' alt="Taxonomy" >Taxonomy</a></li>
                <li id="tab2" aria-controls="komet_mapping_tab"   aria-selected="false" role="tab"  tabindex="-1"><a id="komet_mapping_tab_link"  href='#komet_mapping_tab'  alt="Map Sets">Map Sets</a></li>
                <li id="tab3" aria-controls="komet_refsets_tab"    aria-selected="false" role="tab"  tabindex="-1"><a id="komet_refsets_tab_link"   href='#komet_refsets_tab' alt="Ref Sets" >Ref Sets</a></li>
                <li id="tab4" aria-controls="komet_search_tab"    aria-selected="false" role="tab"  tabindex="-1"><a id="komet_search_tab_link" href='#komet_search_tab'   alt="Search">Search</a></li>
                <li id="tab5" aria-controls="komet_inbox_tab"    aria-selected="false" role="tab"  tabindex="-1"><a id="komet_inbox_tab_link" href='#komet_inbox_tab'    alt="Inbox">Inbox</a></li>
            </ul>
            <div id="komet_taxonomy_tab" aria-hidden="true" aria-labelledby="tab1" role="tabpanel"></div>
            <div id="komet_mapping_tab" aria-hidden="false" aria-labelledby="tab2" role="tabpanel"></div>
            <div id="komet_refsets_tab" aria-hidden="false" aria-labelledby="tab3" role="tabpanel"></div>
            <div id="komet_search_tab"  aria-hidden="false" aria-labelledby="tab4" role="tabpanel"></div>
            <div id="komet_inbox_tab" aria-hidden="false" aria-labelledby="tab5" role="tabpanel"></div>
        </div>
    </div>
    <div id="komet_east_pane"></div>
</div>

<script>
    $(document).ready(function () {

        $("#komet_taxonomy_tab").html('<%= escape_javascript render :partial => 'komet_dashboard/taxonomy/taxonomy'%>');

        $("#komet_dashboard_tabs").tabs({
            activate: function(event, tabs ) {

                if (tabs.newPanel[0].id == "komet_taxonomy_tab"){

                    if (tabs.newPanel.html() == ""){
                        tabs.newPanel.html('<%= escape_javascript render :partial => 'komet_dashboard/taxonomy/taxonomy'%>');
                    }

                } else if (tabs.newPanel[0].id == "komet_mapping_tab"){

                    if (tabs.newPanel.html() == ""){
                        tabs.newPanel.html('<%= escape_javascript render :partial => 'komet_dashboard/mapping/mapping_tree'%>');
                    }

                } else if (tabs.newPanel[0].id == "komet_search_tab"){

                    if (tabs.newPanel.html() == ""){
                        tabs.newPanel.html('<%= escape_javascript render :partial => 'komet_dashboard/search/search'%>');
                    }
                }
            }
        });



        //$("#komet_dashboard_tabs").tabs({active:0});

        // see positioning fix in application.html.erb
        $("#komet_dashboard_splitter").enhsplitter({
            width: "100%",
            position: "41%",
            onDragEnd: function (e) {

                // run this with a small delay because of the way the splitter processes refreshes - it will lose it's reference to the splitter in the refresh and the built in onmouseup handler will error.
                // TODO - See if this is known issue and if not inform splitter developer
                setTimeout(WindowManager.refreshSplitters, 1);
            }
        });
    });
</script>

