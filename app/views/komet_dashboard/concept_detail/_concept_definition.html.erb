<div class="komet-concept-definition-title">CONCEPT</div>

<% @descriptions[:descriptions].each_with_index do |desc_hash, concept_index| %>

    <% if concept_index > 0 %>
        <div class="concept-section-panel-spacer"></div>
    <% end %>

    <div id="komet_concept_definition_panel_<%= @viewer_id %>_<%= desc_hash[:uuid] %>" class="komet-concept-section-panel komet-concept-definition-panel">

      <!-- main header block - always visible -->
      <div class="komet-concept-section-panel-header">

        <!-- expand/collapse icon - controls details drawer -->
        <div class="glyphicon glyphicon-plus-sign" onclick="ConceptsModule.viewers[<%= @viewer_id %>].togglePanelDetails('komet_concept_definition_panel_<%= @viewer_id %>_<%= desc_hash[:uuid] %>')"></div>

        <!-- description type, refset -->
        <div class="komet-concept-definition-title-block">

          <div class="komet-concept-definition-title">
            <%= desc_hash[:description_type_short] %>
          </div>

          <!-- get the case significance and display an appropriate icon -->
          <% if desc_hash[:case_significance_short] == 'true' %>

              <span class="glyphicon glyphicon-text-size" title="<%= desc_hash[:case_significance] %>"></span>

          <% else %>

              <span class="komet-icon-stack" title="<%= desc_hash[:case_significance] %>">
                <span class="glyphicon glyphicon-text-size komet-icon-stack-base"></span>
                <span class="glyphicon glyphicon-ban-circle"></span>
              </span>

          <% end %>

          <span title="<%= desc_hash[:language] %>"><%= desc_hash[:language_short] %></span>
          <span><%= desc_hash[:state] %></span>
        </div>

        <!-- description text -->
        <div class="komet-concept-definition-text">
          <%= desc_hash[:text] %>
        </div>

      </div>

      <!-- details drawer - can be collapsed -->
      <div class="komet-concept-section-panel-details">

        <!-- loop through the description attributes -->
        <% desc_hash[:attributes].each_with_index do |attribute, attribute_index| %>

            <% if attribute_index > 0 %>
                <hr class="komet-concept-definition-details-hr" />
            <% end %>

          <div class="komet-concept-definition-details-row">

            <div class="komet-concept-definition-details-name">
              <%= attribute[:label] %>: <%= attribute[:text] %>
            </div>

            <div class="komet-concept-definition-details-date">
              Date: <%= attribute[:date] %>
            </div>

            <div class="komet-concept-definition-details-user">
              Author: <%= attribute[:author] %>
            </div>
          </div>

        <% end %>

      </div>

    </div>

<% end %>